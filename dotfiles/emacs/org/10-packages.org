* åŒ…

** åŠ è½½ç»“æ„
:properties:
:header-args:emacs-lisp: :tangle no
:end:

Doom é€šè¿‡ =packages.el= æ¥å®‰è£…åŒ…ï¼Œéå¸¸ç®€å•ï¼Œåªéœ€è¦ ~package!~ å°±å¯ä»¥å®‰è£…ã€‚
éœ€è¦æ³¨æ„ï¼Œä¸åº”è¯¥å°†è¯¥æ–‡ä»¶ç¼–è¯‘ä¸ºå­—èŠ‚ç ã€‚
#+begin_src emacs-lisp :tangle "packages.el" :comments no
;; -*- no-byte-compile: t; -*-
;;; $DOOMDIR/packages.el
#+end_src

*è­¦å‘Š*: ä¸è¦ç¦ç”¨ =~/.emacs.d/core/packages.el= ä¸­åˆ—å‡ºçš„åŒ…ã€‚Doom ä¾èµ–è¿™äº›ï¼Œç¦ç”¨å®ƒä»¬
å¯èƒ½å‡ºç°ä¸¥é‡é—®é¢˜ã€‚

- ä»å®˜æ–¹çš„æº [[https://melpa.org/][MELPA]] / [[http://elpa.gnu.org/][GNU ELPA]] / [[https://emacsmirror.net/][emacsmirror]] å®‰è£…
  #+begin_src emacs-lisp
(package! some-package)
  #+end_src
- å…³é—­æŸäº›åŒ…
  #+begin_src emacs-lisp
(package! some-package :disable t)
  #+end_src
- ä» Git Repo å®‰è£…
  #+begin_src emacs-lisp
;; github
(package! github-package :recipe (:host github :repo "username/repo"))
;; gitlab
(package! gitlab-package :recipe (:host gitlab :repo "username/repo"))
;; other
(package! other-package :recipe (:host nil :repo "https://example.com/repo"))
  #+end_src
  å¦‚æœ repo ä»…ä¸­åªæœ‰æŸä¸ª / æŸäº›æ–‡ä»¶æ˜¯ä½ éœ€è¦çš„
  #+begin_src emacs-lisp
(package! some-package
  :recipe (:host github :repo "username/repo"
           :files ("some-file.el" "src/elisp/*.el")))
  #+end_src
  å¦‚æœéœ€è¦æŒ‡å®šæŸä¸ª =commit= æˆ–æŸä¸ª =branch=
  #+begin_src emacs-lisp
;; commit
(package! some-package :pin "abcdefghijk")
;; branch
(package! some-package :recipe (:branch "stable"))
  #+end_src
- ä½¿ç”¨æœ¬åœ°çš„ repo
  #+begin_src emacs-lisp
(package! some-package :recipe (:local-repo "/path/to/repo"))
  #+end_src

** å·¥å…·

*** Which-key

#+begin_comment
æ¥è‡ª =:core packages= æ¨¡å—
#+end_comment

è®©å¿«æ·é”®æç¤ºå˜å¾—æ›´å¿«ï¼
#+begin_src emacs-lisp
(setq which-key-idle-delay 0.5)
#+end_src

*** Input

**** String Inflection

+å˜å½¢æ±½è½¦äººï¼+ å˜å½¢å­—ç¬¦ä¸²ï¼
#+begin_src emacs-lisp :tangle packages.el
(package! string-inflection)
#+end_src

#+begin_src emacs-lisp
(use-package! string-inflection
  :defer t
  :init
  (map! :leader :prefix ("cS" . "naming convention")
        :desc "cycle" "~" #'string-inflection-all-cycle
        :desc "toggle" "t" #'string-inflection-toggle
        :desc "CamelCase" "c" #'string-inflection-camelcase
        :desc "downCase" "d" #'string-inflection-lower-camelcase
        :desc "kebab-case" "k" #'string-inflection-kebab-case
        :desc "under_score" "u" #'string-inflection-underscore
        :desc "Upper_Score" "_" #'string-inflection-capital-underscore
        :desc "UP_CASE" "U" #'string-inflection-upcase))
#+end_src

*** hungry delete

ä¸€æ¬¡ ~backspace~ åƒæ‰æ‰€æœ‰ç©ºç™½ç¬¦ (å½“å‰å…‰æ ‡é™å®š)
#+begin_src emacs-lisp :tangle packages.el
(package! hungry-delete :recipe (:host github :repo "nflath/hungry-delete"))
#+end_src

åªè®©å®ƒåº”ç”¨åœ¨ç¼–ç¨‹æ¨¡å¼æ˜¯æœ€å¥½çš„
#+begin_src emacs-lisp
(use-package! hungry-delete
  :config
  (setq-default hungry-delete-chars-to-skip " \t\v")
  (add-hook! prog-mode #'hungry-delete-mode))
#+end_src

*** Dired

#+begin_comment
æ¥è‡ª =:emacs dired= æ¨¡å—
#+end_comment

emacs è‡ªå¸¦çš„å¼ºå¤§æ–‡ä»¶ç®¡ç†å™¨ï¼Œå’Œä¹‹åæåˆ°çš„ [[Magit]]ã€[[TRAMP]] éƒ½æ˜¯ Emacs çš„æ€æ‰‹çº§åº”ç”¨ã€‚
è¿˜å‡ºç°äº†å¾ˆå¤šå¢å¼ºæ€§çš„åŒ…æ¥å¢åŠ å…¶èƒ½åŠ›ï¼Œä¸è¿‡å¯¹æˆ‘æ¥è¯´ï¼Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹ä¹Ÿå°±å¤Ÿäº†ã€‚

#+begin_src emacs-lisp
(after! dired
  (require 'dired-async)
  (define-key! dired-mode-map "RET" #'dired-find-alternate-file)
  (define-key! dired-mode-map "C" #'dired-async-do-copy)
  (define-key! dired-mode-map "H" #'dired-async-do-hardlink)
  (define-key! dired-mode-map "R" #'dired-async-do-rename)
  (define-key! dired-mode-map "S" #'dired-async-do-symlink)
  (define-key! dired-mode-map "n" #'dired-next-marked-file)
  (define-key! dired-mode-map "p" #'dired-prev-marked-file)
  (define-key! dired-mode-map "=" #'ginshio/dired-ediff-files)
  (define-key! dired-mode-map "<mouse-2>" #'dired-mouse-find-file)
  (defun ginshio/dired-ediff-files ()
    "Mark files and ediff in dired mode, you can mark 1, 2 or 3 files and diff.
see: https://oremacs.com/2017/03/18/dired-ediff/"
    (let ((files (dired-get-marked-files)))
      (cond ((= (length files) 0))
            ((= (length files) 1)
             (let ((file1 (nth 0 files))
                   (file2 (read-file-name "file: " (dired-dwim-target-directory))))
               (ediff-files file1 file2)))
            ((= (length files) 2)
             (let ((file1 (nth 0 files)) (file2 (nth 1 files)))
               (ediff-files file1 file2)))
            ((= (length files) 3)
             (let ((file1 (car files)) (file2 (nth 1 files)) (file3 (nth 2 files)))
               (ediff-files3 file1 file2 file3)))
            (t (error "no more than 3 files should be marked")))))
  (define-advice dired-do-print (:override (&optional _))
    "show/hide dotfiles in current dired
see: https://www.emacswiki.org/emacs/DiredOmitMode"
    (cond ((or (not (boundp 'dired-dotfiles-show-p)) dired-dotfiles-show-p)
           (setq-local dired-dotfiles-show-p nil)
           (dired-mark-files-regexp "^\\.")
           (dired-do-kill-lines))
          (t (revert-buffer)
             (setq-local dired-dotfiles-show-p t))))
  (define-advice dired-up-directory (:override (&optional _))
    "goto up directory in this buffer"
    (find-alternate-file ".."))
  (define-advice dired-do-compress-to (:override (&optional _))
    "Compress selected files and directories to an archive."
    (let* ((output (read-file-name "Compress to: "))
           (command-assoc (assoc output dired-compress-files-alist 'string-match))
           (files-str (mapconcat 'identity (dired-get-marked-files t) " ")))
      (when (and command-assoc (not (string= "" files-str)))
        (let ((command (format-spec (cdr command-assoc)
                                    `((?o . ,output)
                                      (?i . ,files-str)))))
          (async-start (lambda () (shell-command command)) nil))))))
#+end_src

*** Magit
:properties:
:header-args:emacs-lisp: :tangle no :noweb-ref magit-tweaks
:end:

#+begin_comment
æ¥è‡ª =:tools magit= æ¨¡å—
#+end_comment

[[https://xkcd.com/1597][xkcd:1597]]

è¿™åº”è¯¥æ˜¯ Emacs çš„æ€æ‰‹åº”ç”¨ä¹‹ä¸€äº†ï¼Œæ„Ÿè°¢ [[https://github.com/tarsius][Jonas]] åŠå…¶ä»–è´¡çŒ®è€…ã€‚

#+begin_src emacs-lisp :noweb no-export :tangle yes :noweb-prefix no :noweb-ref nil
(after! magit
  <<magit-tweaks>>
  )
#+end_src

**** Delta

[[https://github.com/dandavison/delta/][Delta]] æ˜¯ç”¨ rust å®ç°çš„ git diff è¯­æ³•é«˜äº®çš„å·¥å…·ã€‚è¯¥ä½œè€…è¿˜å°†å…¶æŒ‚æ¥åˆ°äº† magit çš„
diff è§†å›¾ä¸Š (é»˜è®¤ä¸ä¼šæœ‰è¯­æ³•é«˜äº®)ã€‚ä¸è¿‡è¿™éœ€è¦ =delta= äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåœ¨ cargo å®‰è£…
æ˜¾å¾—ç®€å•äº›ï¼Œä¸è¿‡ä½ ä¹Ÿå¯ä»¥é€‰æ‹© [[https://github.com/dandavison/delta/releases/latest][GitHub Release]]ã€‚å½“ç„¶ï¼Œæˆ‘åœ¨ç”¨ openSUSE tumbleweedï¼Œ
å¯ä»¥ä»è½¯ä»¶æºä¸­ä¸‹è½½

#+begin_src shell :tangle no
cargo install git-delta
sudo zypper install git-delta
#+end_src

ç®€å•åœ°é…ç½®å®ƒå°±è¡Œ
#+begin_src emacs-lisp :noweb-ref none :tangle packages.el
(package! magit-delta :recipe (:host github :repo "dandavison/magit-delta"))
#+end_src

#+begin_src emacs-lisp
(use-package! magit-delta
  :after magit
  :hook (magit-mode . magit-delta-mode))
#+end_src

**** Code Review

Github / Gitlab ä¸Šå»è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦äº†ï¼Œåœ¨æœ¬åœ°ç›´æ¥è®¿é—®ã€æ“ä½œè¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚Magit æä¾›
äº† forge æ¥å®ç°åœ¨ emacs ä¸­ code reviewï¼

#+begin_src emacs-lisp :noweb-ref none :tangle packages.el
(package! forge :recipe (:host github :repo "magit/forge"))
#+end_src

#+begin_src emacs-lisp
(use-package! forge
  :after magit)
#+end_src

**** å†²çª

åœ¨ Emacs ä¸­å¤„ç†å†²çªä¹Ÿæ˜¯ä¸é”™çš„ä½“éªŒï¼Œæˆ–è®¸å¯ä»¥å°è¯•è‡ªå·±åˆ¶é€ ä¸€ç‚¹ã€‚å½“ç„¶ï¼Œediff ç›¸å½“å¥½
ç”¨ã€‚
emmm... ä¹‹å‰ä¸ºä»€ä¹ˆè¦ç”¨ smerge æ¥ç€ã€‚åº”è¯¥æ˜¯ä¸æƒ³ç¦»å¼€ emacs ç¯å¢ƒã€‚

#+begin_src emacs-lisp :tangle no
(defun smerge-repeatedly ()
  "Perform smerge actions again and again"
  (interactive)
  (smerge-mode 1)
  (smerge-transient))
(after! transient
  (transient-define-prefix smerge-transient ()
    [["Move"
      ("n" "next" (lambda () (interactive) (ignore-errors (smerge-next)) (smerge-repeatedly)))
      ("p" "previous" (lambda () (interactive) (ignore-errors (smerge-prev)) (smerge-repeatedly)))]
     ["Keep"
      ("b" "base" (lambda () (interactive) (ignore-errors (smerge-keep-base)) (smerge-repeatedly)))
      ("u" "upper" (lambda () (interactive) (ignore-errors (smerge-keep-upper)) (smerge-repeatedly)))
      ("l" "lower" (lambda () (interactive) (ignore-errors (smerge-keep-lower)) (smerge-repeatedly)))
      ("a" "all" (lambda () (interactive) (ignore-errors (smerge-keep-all)) (smerge-repeatedly)))
      ("RET" "current" (lambda () (interactive) (ignore-errors (smerge-keep-current)) (smerge-repeatedly)))]
     ["Diff"
      ("<" "upper/base" (lambda () (interactive) (ignore-errors (smerge-diff-base-upper)) (smerge-repeatedly)))
      ("=" "upper/lower" (lambda () (interactive) (ignore-errors (smerge-diff-upper-lower)) (smerge-repeatedly)))
      (">" "base/lower" (lambda () (interactive) (ignore-errors (smerge-diff-base-lower)) (smerge-repeatedly)))
      ("R" "refine" (lambda () (interactive) (ignore-errors (smerge-refine)) (smerge-repeatedly)))
      ("E" "ediff" (lambda () (interactive) (ignore-errors (smerge-ediff)) (smerge-repeatedly)))]
     ["Other"
      ("c" "combine" (lambda () (interactive) (ignore-errors (smerge-combine-with-next)) (smerge-repeatedly)))
      ("r" "resolve" (lambda () (interactive) (ignore-errors (smerge-resolve)) (smerge-repeatedly)))
      ("k" "kill current" (lambda () (interactive) (ignore-errors (smerge-kill-current)) (smerge-repeatedly)))
      ("q" "quit" (lambda () (interactive) (smerge-auto-leave)))]]))
#+end_src

*** Completion

#+begin_comment
æ¥è‡ª =:completion corfu= æ¨¡å—
#+end_comment

æ²¡æœ‰è¡¥å…¨æ€ä¹ˆå†™ä»£ç ï¼Œå°¤å…¶æ˜¯ =Java=â€‹ï¼ï¼ï¼
#+begin_src emacs-lisp
(after! corfu
 (corfu-history-mode t)
 (corfu-indexed-mode t)
 )
#+end_src

*** Vertico

#+begin_comment
æ¥è‡ª =:completion vertico= æ¨¡å—
#+end_comment

#+begin_src emacs-lisp
(after! consult
  (set-face-attribute 'consult-file nil :inherit 'consult-buffer)
  (setf (plist-get (alist-get 'perl consult-async-split-styles-alist) :initial) ";"))
#+end_src

*** LSP

#+begin_comment
æ¥è‡ª =:tools lsp= æ¨¡å—
#+end_comment

è¿™ä¸æ˜¯è€è‰²æ‰¹ï¼è‡ªä» lsp æ™®åŠå¼€å§‹ï¼Œæ— è®ºé…ç½®ä»€ä¹ˆç¼–è¾‘å™¨éƒ½ä¸å†å¤æ‚äº†ã€‚çœ‹äº†ä¸€åœˆ
[[https://emacs-lsp.github.io/lsp-mode/tutorials/][lsp-mode tutorial]] ç”šè‡³è§‰å¾—ä¸éœ€è¦é…ç½®ä»€ä¹ˆï¼Œä¼°è®¡ doom ä¹Ÿæœ‰ç›¸åº”çš„é…ç½®ã€‚é—®é¢˜å°±æ˜¯ï¼Œç†Ÿ
æ‚‰é…ç½®ã€æ“ä½œçš„é—®é¢˜ã€‚

#+begin_src emacs-lisp
(use-package! eglot
  :init
  (setq! eglot-code-action-indications nil
         eglot-autoshutdown t
         ; Performance issue: https://github.com/joaotavora/eglot/discussions/993
         eldoc-idle-delay 0.75
         company-idle-delay 0.75
         flymake-no-changes-timeout 0.5
         ; Copy from https://andreyor.st/posts/2023-09-09-migrating-from-lsp-mode-to-eglot/
         eglot-ignored-server-capabilities '(:colorProvider
                                             :documentFormattingProvider
                                             :documentLinkProvider
                                             :documentOnTypeFormattingProvider
                                             :documentRangeFormattingProvider
                                             :foldingRangeProvider
                                             :inlayHintProvider)
         eglot-stay-out-of '(yasnippet)
         eglot-events-buffer-size 0
         eglot-extend-to-xref nil)
  :config
  (add-hook 'eglot-managed-mode-hook (lambda () (setq-local eldoc-documentation-strategy
                                                            #'eldoc-documentation-compose)))
  (advice-add 'jsonrpc--log-event :override #'ignore)
  (add-to-list 'eglot-server-programs
               '((cc-mode c++-mode c-mode) . ("clangd" "-j=2" "--clang-tidy" "--header-insertion=iwyu")))
  :hook
  ((cc-mode c++-mode c-mode) . eglot-ensure))
#+end_src

*** Tree sitter

#+begin_comment
æ¥è‡ª =:tools tree-sitter= æ¨¡å—
#+end_comment

ç»“æ„åŒ–ç¼–è¾‘ä¼¼ä¹æˆä¸ºäº†ä¸»æµï¼Œä¸è¿‡ combobulate æ”¯æŒçš„å¤ªå°‘äº†ã€‚æš‚ä¸è€ƒè™‘ã€‚

#+begin_src emacs-lisp :tangle no
(package! combobulate :recipe (:host github :repo "mickeynp/combobulate"))
#+end_src

*** æ ¼å¼åŒ–

#+begin_comment
æ¥è‡ª =:tools format= æ¨¡å—
#+end_comment

æ ¼å¼åŒ–ä»£ç æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„äº‹æƒ…ï¼Œä½†æ˜¯ï¼Œæˆ‘å¸Œæœ›è¿˜æ˜¯ä¸è¦å†ä¿å­˜çš„æ—¶å€™æ ¼å¼åŒ–äº†ï¼è¿™ä¼šè®©ä»£
ç å˜å¾—å¥‡æ€ªï¼Œå°¤å…¶æ˜¯åˆä½œçš„é¡¹ç›®ä¸Šã€‚å½“ç„¶ä½ å¯ä»¥æ‰‹åŠ¨ç”¨ ~+format/buffer~ åœ¨éœ€è¦çš„æ—¶å€™æ ¼å¼
åŒ–ä»£ç ã€‚ä½†æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™æ²¡ä»€ä¹ˆç”¨ã€‚

#+begin_src emacs-lisp :tangle no
(appendq! +format-on-save-disabled-modes
          '(c-mode
            c++-mode
            python-mode))
#+end_src

å¦å¤–ï¼Œä¸è¦è®© lsp æ±¡æŸ“ formatï¼
#+begin_src emacs-lisp
(setq +format-with-lsp nil)
#+end_src

*** TRAMP

å…³äºå…¶ä»–å¾ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼ŒTRAMP ç®—ä¸€ä¸ªï¼Œå®ƒæ˜¯å¤šåè®®é€æ˜è¿œç¨‹è®¿é—® (/Transparent Remote
Access, Multiple Protocol/) å·¥å…·ã€‚ç®€å•è¯´è¿™æ˜¯ç®€å•è®¿é—®å…¶ä»–ä¸»æœºæ–‡ä»¶ç³»ç»Ÿçš„æ–¹æ³•ã€‚

å¦‚æœä½ æƒ³ä½¿ç”¨ =ssh-key=â€‹ï¼Œå»ºè®®å¼€å§‹ä½¿ç”¨ ~ssh config~â€‹ï¼Œå¹¶ç”¨ ~sshx:~ è¿›è¡Œ tramp è¿æ¥ã€‚

ä¸å¹¸çš„æ˜¯ï¼ŒTRAMP å¯¹è¿œç¨‹è¿æ¥æ—¶ SHELL çš„æç¤ºæ ¼å¼å¾ˆæŒ‘å‰”ï¼Œå°è¯•ä½¿ç”¨ bash å¹¶æ”¾å®½æ¾æç¤º
åŒºåŸŸçš„è¯†åˆ«ã€‚

#+begin_src emacs-lisp
(after! tramp
  (setenv "SHELL" "/bin/bash")
  (setq tramp-shell-prompt-pattern
        "\\(?:^\\|
\\)[^]#$%>\n]*#?[]#$%>î‚°] *\\(\\[[0-9;]*[a-zA-Z] *\\)*"))  ;; default + î‚°
#+end_src

*** VTerm

#+begin_quote
As good as terminal emulation gets in Emacs
#+end_quote

VTerm çš„å®‰è£…ç›¸å¯¹éº»çƒ¦ä¸€äº›ï¼Œéœ€è¦ç¼–è¯‘ä¸€äº›ä¾èµ–ã€‚å½“ç„¶å¯¹äº Unix ç”¨æˆ·ï¼Œç”¨ç³»ç»Ÿåº“æ›´åŠ æ–¹ä¾¿ï¼
#+begin_src emacs-lisp
(setq! vterm-module-cmake-args "-DUSE_SYSTEM_LIBVTERM=yes")
#+end_src

*** YASnippet

#+begin_comment
æ¥è‡ª =:editor snippets= æ¨¡å—
#+end_comment

snippets å¥—å¨ƒè°ç”¨è°çŸ¥é“ï¼
#+begin_src emacs-lisp
(setq yas-triggers-in-field t)
#+end_src

*** Screenshot

#+begin_notes
screenshot ä¾èµ–äº [[https://imagemagick.org/index.php][ImageMagick]]
#+end_notes

è®©æˆªå›¾å˜å¾—è½»è€Œæ˜“ä¸¾ï¼
#+begin_src emacs-lisp :tangle packages.el
(package! screenshot
  :recipe (:host github :repo "tecosaur/screenshot")
  )
#+end_src

#+begin_src emacs-lisp
(use-package! screenshot
  :defer t
  :config (setq screenshot-upload-fn "upload %s 2>/dev/null"))
#+end_src

ä½œè€…å¹¶æ²¡æœ‰æ‰“ç®—æ·»åŠ  TUI æ”¯æŒã€‚

** UI

*** Nyan

é¦–å…ˆæ·»åŠ ä¸€ä¸‹å½©è™¹çŒ«ï¼Œè¿™ä¸èƒ½å¿˜ï¼
#+begin_src emacs-lisp :tangle "packages.el"
(package! nyan-mode :recipe (:host github :repo "TeMPOraL/nyan-mode"))
#+end_src

#+begin_src emacs-lisp
(use-package! nyan-mode
  :config
  (setq nyan-animate-nyancat t
        nyan-wavy-trail t
        nyan-cat-face-number 4
        nyan-bar-length 16
        nyan-minimum-window-width 64)
  (add-hook! doom-modeline #'nyan-mode))
#+end_src

*** Eros

#+begin_comment
æ¥è‡ª =:tools eval= æ¨¡å—
#+end_comment

è¿™ä¸ªåŒ…å¯ä»¥ä¿®æ”¹ emacs lisp å†…è”æ‰§è¡Œçš„è§†è§‰æ•ˆæœï¼Œè®©è¿™ä¸ªç»“æœçš„å‰ç¼€æ›´å¥½çœ‹ä¸€ç‚¹ã€‚
#+begin_src emacs-lisp
(setq eros-eval-result-prefix "âŸ¹ ") ; default =>
#+end_src

ä½ å¯ä»¥ç”¨ =C-x C-e= æ¥å¯¹æ¯”ä¸€ä¸‹å‰åå˜åŒ–
#+begin_src emacs-lisp :tangle no :results vaule replace
(+ 1 1 (* 2 2) 1)
#+end_src

#+RESULTS:
: 7

#+begin_src python :tangle no :results vaule replace
return 2 ** 4
#+end_src

#+RESULTS:
: 16

*** Theme Magic

éå¸¸ç¥å¥‡çš„æ˜¯ä½ å¯ä»¥åœ¨ Emacs ä¸­ç”¨ç°æœ‰çš„ Themeï¼Œæ”¹å˜ç»ˆç«¯çš„ Themeï¼Œä¸” GUI å’Œ TUI éƒ½
å¯ç”¨ï¼ä½œè€…è¯´ Linux å’Œ Mac å¯ç”¨ï¼Œâ€‹=Windows Terminal= + =WSL= åŒæ ·é€‚ç”¨ï¼Œå‹åŠ›æ¥åˆ°äº†
çº¯ Windows ä¸‹çš„ Emacsã€‚

#+begin_src emacs-lisp :tangle packages.el
(package! theme-magic)
#+end_src

è¿™ä¸ªæ“ä½œä½¿ç”¨ =pywal=â€‹ï¼Œä½ å¯ä»¥é€šè¿‡ä»“åº“å®‰è£…å®ƒï¼Œä¸è¿‡æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ =pip=â€‹ã€‚

#+begin_src shell :tangle no
sudo python3 -m pip install pywal
#+end_src

Theme Magic æä¾›äº†ä¸€ä¸ªæ•°å­—ç•Œé¢ï¼Œå°è¯•ä»é¥±å’Œåº¦ã€è‰²å½©å·®å¼‚æ¥æœ‰æ•ˆçš„é€‰å–å…«ä¸ªé¢œè‰²ã€‚ç„¶è€Œï¼Œå®ƒ
å¯èƒ½ä¼šä¸º light é€‰æ‹©ç›¸åŒçš„é¢œè‰²ï¼Œå¹¶ä¸æ€»èƒ½å¤Ÿé€‰å–æœ€ä½³é¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ Doom themes
æä¾›çš„è‰²å½©å·¥å…·æ¥è½»æ¾è·å–åˆç†çš„é…è‰²æ¥ç”Ÿæˆ light ç‰ˆæœ¬ --- ç°åœ¨å°±å¼€å§‹ï¼

#+begin_src emacs-lisp
(use-package! theme-magic
  :defer t
  :after +doom-dashboard
  :config
  (defadvice! theme-magic--auto-extract-16-doom-colors ()
    :override #'theme-magic--auto-extract-16-colors
    (list
     (face-attribute 'default :background)
     (doom-color 'error)
     (doom-color 'success)
     (doom-color 'type)
     (doom-color 'keywords)
     (doom-color 'constants)
     (doom-color 'functions)
     (face-attribute 'default :foreground)
     (face-attribute 'shadow :foreground)
     (doom-blend 'base8 'error 0.1)
     (doom-blend 'base8 'success 0.1)
     (doom-blend 'base8 'type 0.1)
     (doom-blend 'base8 'keywords 0.1)
     (doom-blend 'base8 'constants 0.1)
     (doom-blend 'base8 'functions 0.1)
     (face-attribute 'default :foreground))))
#+end_src

*** Info ç€è‰²

è®© info å˜å¾—æ›´åŠ ç»šä¸½å¤ºç›®ã€‚

#+begin_src emacs-lisp :tangle packages.el
(package! info-colors)
#+end_src

#+begin_src emacs-lisp
(use-package! info-colors
  :after info
  :commands (info-colors-fontify-node)
  :hook (Info-selection . info-colors-fontify-node))
#+end_src

*** Tabs

#+begin_comment
æ¥è‡ª =:ui tabs= æ¨¡å—
#+end_comment

å¦‚æœä½ æƒ³åƒç°ä»£ç¼–è¾‘å™¨ä¸€æ ·æ‹¥æœ‰ tabsï¼Œæˆ–è®¸ä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹ã€‚å¦‚æœæƒ³è¦ tabs åº•ä¸‹æ˜¾ç¤º
=bar=â€‹ï¼Œéœ€è¦å¼€å¯ ~x-underline-at-descent-line~
#+begin_src emacs-lisp :tangle no
(after! centaur-tabs
  (setq! centaur-tabs-style "bar"
         centaur-tabs-set-icons t
         centaur-tabs-plain-icons nil
         centaur-tabs-set-modified-marker t
         centaur-tabs-show-navigation-buttons nil
         centaur-tabs-gray-out-icons 'buffer
         centaur-tabs-set-bar 'under
         x-underline-at-descent-line t
         centaur-tabs-label-fixed-length 9)
  (defun centaur-tabs-hide-tab (x)
    "Do no to show buffer X in tabs."
    (let ((name (format "%s" x)))
      (or
       ;; Current window is not dedicated window.
       (window-dedicated-p (selected-window))
       ;; Buffer name not match below blacklist.
       (string-prefix-p "*epc" name)
       (string-prefix-p "*helm" name)
       (string-prefix-p "*Helm" name)
       (string-prefix-p "*Compile-Log*" name)
       (string-prefix-p "*lsp" name)
       (string-prefix-p "*company" name)
       (string-prefix-p "*Flycheck" name)
       (string-prefix-p "*tramp" name)
       (string-prefix-p " *Mini" name)
       (string-prefix-p "*help" name)
       (string-prefix-p "*straight" name)
       (string-prefix-p " *temp" name)
       (string-prefix-p "*Help" name)
       (string-prefix-p "*mybuf" name)
       (string-prefix-p "â–º Doom" name)
       ;; Is not magit buffer.
       (and (string-prefix-p "magit" name)
            (not (file-name-extension name)))
       )))
  (centaur-tabs-group-by-projectile-project)
  (centaur-tabs-mode t))
#+end_src

ä½†æ˜¯åˆ«å¿˜äº†ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶[[æ¥å£]]ä¸­å¼€å¯ =tabs= é€‰é¡¹ã€‚è¿˜ä¸èƒ½å¿˜è®°æ·»åŠ å¿«æ·é”®
#+begin_src emacs-lisp :tangle no
(map! :map ctl-x-map
      :prefix ("t" . "Tab and Treemacs")
      "a"   #'centaur-tabs-select-beg-tab
      "e"   #'centaur-tabs-select-end-tab
      "f"   #'centaur-tabs-forward-tab
      "F"   #'centaur-tabs-forward-group
      "b"   #'centaur-tabs-backward-tab
      "B"   #'centaur-tabs-backward-group
      "g"   #'centaur-tabs-switch-group
      "G"   #'centaur-tabs-toggle-groups
      "l"   #'centaur-tabs-move-current-tab-to-left
      "r"   #'centaur-tabs-move-current-tab-to-right
      "k"   #'centaur-tabs-kill-other-buffers-in-current-group
      "K"   #'centaur-tabs-kill-unmodified-buffers-in-current-group
      "C-5" #'centaur-tabs-extract-window-to-new-frame
      "C-o" #'centaur-tabs-open-in-external-application
      "C-d" #'centaur-tabs-open-directory-in-external-application
      )
#+end_src

*** Nerd Icons

#+begin_comment
æ¥è‡ª =:core packages= æ¨¡å—
#+end_comment

ç°åœ¨ Doom emacs ä½¿ç”¨ =nerd-icons=â€‹ã€‚

#+begin_src emacs-lisp :tangle no
(after! nerd-icons
  (when-let ((matlab-icon (assoc "matlab" nerd-icons-extension-icon-alist)))
    (setcdr (assoc "m" nerd-icons-extension-icon-alist)
            (cdr matlab-icon))))
#+end_src

*** hl todo

#+begin_comment
æ¥è‡ª =:ui hl-todo= æ¨¡å—
#+end_comment

~hl-todo~ å…è®¸ä½ è®¾ç½®ä¸€äº›å…³é”®å­—ï¼Œè¿™äº›å…³é”®å­—å°†é«˜äº®å¹¶ä¸”ä¾¿äºæŸ¥æ‰¾ã€‚å¾€å¾€ç”¨äºä»£ç æ³¨é‡Šä¸­
å¼ºè°ƒæŸäº›å†…å®¹ã€‚
#+begin_src emacs-lisp
(custom-set-variables
 '(hl-todo-keyword-faces '(("NOTE" font-lock-builtin-face bold) ;; needs discussion or further investigation.
                           ("REVIEW" font-lock-keyword-face bold) ;; review was conducted.
                           ("HACK" font-lock-variable-name-face bold) ;; workaround a known problem.
                           ("DEPRECATED" region bold) ;; why it was deprecated and to suggest an alternative.
                           ("XXX+" font-lock-constant-face bold) ;; warn other programmers of problematic or misguiding code.
                           ("TODO" font-lock-function-name-face bold) ;; tasks/features to be done.
                           ("FIXME" font-lock-warning-face bold) ;; problematic or ugly code needing refactoring or cleanup.
                           ("KLUDGE" font-lock-preprocessor-face bold )
                           ("BUG" error bold) ;; a known bug that should be corrected.
                           )))
#+end_src
